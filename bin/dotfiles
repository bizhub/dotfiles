#!/usr/bin/env bash

COMMAND_NAME=$1

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
BLUE='\033[0;34m'
NC='\033[0m'

export DOTFILES_DIR
DOTFILES_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && cd .. && pwd )"

cmd_help() {
    echo -e "${BLUE}Usage:${NC}"
    echo "  dotfiles [<command_name>]"
    echo
    echo "Commands:"
    echo -e "   ${GREEN}help${NC}             Display this help message"
    echo -e "   ${GREEN}update${NC}           Update package manager and packages (OS, node, npm, commposer)"
    echo -e "   ${GREEN}symlinks${NC}         Run symlinks script"
}

cmd_update() {
    sudo apt update
    sudo apt upgrade -yy

    # ...
}

cmd_symlinks() {
    . "$DOTFILES_DIR/install/symlinks.sh"
}

if [ "$COMMAND_NAME" = "" ]; then
    cmd_help
    exit
fi

cmd_${COMMAND_NAME} 2> /dev/null
if [ $? = 127 ]; then
    echo -e "${RED}Error: '$COMMAND_NAME' is not a known command.${NC}" >&2
    cmd_help
    exit
fi
